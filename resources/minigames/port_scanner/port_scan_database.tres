[gd_resource type="Resource" script_class="PortScanDatabase" load_steps=20 format=3 uid="uid://port_scan_db"]

[ext_resource type="Script" path="res://assets/scripts/minigames/port_scanner/PortScanDatabase.gd" id="1"]
[ext_resource type="Script" path="res://assets/scripts/minigames/port_scanner/PortScanResource.gd" id="2"]

[sub_resource type="Resource" id="1"]
resource_name = "TraficoLegitimo1"
script = ExtResource("2")
source_ip = "192.168.1.105"
target_port = 443
protocol = "TCP"
scan_type = "Conexión HTTPS establecida"
packet_count = 28
time_span = "10 minutos"
description = "Conexión establecida desde dispositivo interno hacia servidor web seguro. Intercambio normal de datos cifrados. Sesión TLS/SSL activa con certificado válido."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Conexión HTTPS normal hacia servidor web. Puerto 443 es estándar para navegación web segura."
hint = "El puerto 443 es el puerto estándar para HTTPS. La duración y cantidad de paquetes son normales para navegación web."

[sub_resource type="Resource" id="2"]
resource_name = "SYNScan"
script = ExtResource("2")
source_ip = "203.0.113.45"
target_port = 22
protocol = "TCP"
scan_type = "SYN Scan (Half-open)"
packet_count = 250
time_span = "15 segundos"
description = "Múltiples paquetes SYN enviados a puerto SSH sin completar handshake. Origen externo desconocido. Patrón típico de reconocimiento de servicios."
is_malicious = true
threat_type = "Port Scanning - SYN Stealth Scan"
explanation = "ATAQUE: SYN Scan es una técnica de escaneo sigiloso. 250 paquetes en 15 segundos indica reconocimiento automatizado del puerto SSH."
hint = "Los escaneos SYN son sigilosos porque no completan el handshake TCP. Alto volumen en poco tiempo es sospechoso."

[sub_resource type="Resource" id="3"]
resource_name = "TraficoLegitimo2"
script = ExtResource("2")
source_ip = "10.0.0.50"
target_port = 3306
protocol = "TCP"
scan_type = "Conexión MySQL persistente"
packet_count = 142
time_span = "30 minutos"
description = "Servidor de aplicaciones conectado a base de datos MySQL. Consultas periódicas dentro de red interna. Pool de conexiones activo."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Conexión interna entre servidor de aplicaciones y base de datos MySQL. Es tráfico normal de producción."
hint = "Conexiones internas (10.x.x.x) a bases de datos son normales. El tiempo prolongado indica sesión persistente legítima."

[sub_resource type="Resource" id="4"]
resource_name = "XmasScan"
script = ExtResource("2")
source_ip = "198.51.100.22"
target_port = 445
protocol = "TCP"
scan_type = "Xmas Scan (FIN+PSH+URG)"
packet_count = 180
time_span = "8 segundos"
description = "Paquetes TCP con flags anómalas (FIN+PSH+URG) dirigidos al puerto SMB. Técnica de evasión de IDS. Origen externo no autorizado."
is_malicious = true
threat_type = "Port Scanning - Xmas Tree Scan"
explanation = "ATAQUE: Xmas Scan usa flags TCP anómalas para evadir detección. El puerto 445 (SMB) es objetivo común de ataques."
hint = "Flags TCP inusuales combinadas son señal de escaneo. El puerto 445 es de alto riesgo y frecuentemente atacado."

[sub_resource type="Resource" id="5"]
resource_name = "TraficoLegitimo3"
script = ExtResource("2")
source_ip = "172.16.0.100"
target_port = 80
protocol = "TCP"
scan_type = "Petición HTTP GET"
packet_count = 12
time_span = "2 minutos"
description = "Petición HTTP normal desde cliente interno. Descarga de recursos web. Headers estándar con User-Agent válido."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Petición HTTP GET normal. Bajo volumen de paquetes para una petición web estándar."
hint = "Peticiones HTTP con pocos paquetes en tiempo razonable son normales. Navegación web típica."

[sub_resource type="Resource" id="6"]
resource_name = "NULLScan"
script = ExtResource("2")
source_ip = "unknown/spoofed"
target_port = 23
protocol = "TCP"
scan_type = "NULL Scan (sin flags)"
packet_count = 320
time_span = "12 segundos"
description = "Paquetes TCP sin flags hacia puerto Telnet. IP origen probablemente falsificada. Patrón de fingerprinting de sistemas operativos."
is_malicious = true
threat_type = "Port Scanning - NULL Scan + IP Spoofing"
explanation = "ATAQUE SOFISTICADO: NULL Scan con IP falsificada hacia Telnet (puerto inseguro). Intento de evadir detección y mapear servicios."
hint = "NULL Scans no tienen flags TCP (anómalo). IP desconocida + puerto Telnet + alto volumen = definitivamente malicioso."

[sub_resource type="Resource" id="7"]
resource_name = "TraficoLegitimo4"
script = ExtResource("2")
source_ip = "192.168.1.200"
target_port = 53
protocol = "UDP"
scan_type = "Consulta DNS"
packet_count = 4
time_span = "1 segundo"
description = "Resolución DNS desde cliente interno. Consulta tipo A para dominio legítimo. Respuesta recibida del servidor DNS corporativo."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Consulta DNS normal. DNS usa UDP puerto 53 y requiere pocos paquetes por consulta."
hint = "DNS es esencial para internet. Pocas consultas UDP al puerto 53 son completamente normales."

[sub_resource type="Resource" id="8"]
resource_name = "FINScan"
script = ExtResource("2")
source_ip = "203.0.113.88"
target_port = 3389
protocol = "TCP"
scan_type = "FIN Scan"
packet_count = 290
time_span = "20 segundos"
description = "Múltiples paquetes FIN hacia puerto RDP sin conexión previa. Técnica de escaneo sigiloso. Intento de identificar servicios de escritorio remoto."
is_malicious = true
threat_type = "Port Scanning - FIN Scan to RDP"
explanation = "ATAQUE: FIN Scan dirigido a RDP (Remote Desktop Protocol). RDP es objetivo crítico para acceso remoto no autorizado."
hint = "Paquetes FIN sin conexión establecida son anómalos. RDP (puerto 3389) es objetivo de alto valor para atacantes."

[sub_resource type="Resource" id="9"]
resource_name = "TraficoLegitimo5"
script = ExtResource("2")
source_ip = "10.50.0.25"
target_port = 22
protocol = "TCP"
scan_type = "Sesión SSH autenticada"
packet_count = 89
time_span = "15 minutos"
description = "Sesión SSH establecida desde administrador de sistemas. Autenticación por clave pública exitosa. Comandos administrativos ejecutándose."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Sesión SSH administrativa desde red interna. Autenticación válida y tiempo de sesión razonable."
hint = "SSH desde red interna con sesión establecida es administración legítima. El tiempo y paquetes son normales."

[sub_resource type="Resource" id="10"]
resource_name = "ACKScan"
script = ExtResource("2")
source_ip = "198.51.100.156"
target_port = 8080
protocol = "TCP"
scan_type = "ACK Scan"
packet_count = 400
time_span = "10 segundos"
description = "Inundación de paquetes ACK sin contexto de conexión. Intento de mapear reglas de firewall. Patrón automatizado desde IP externa."
is_malicious = true
threat_type = "Port Scanning - ACK Scan (Firewall Mapping)"
explanation = "ATAQUE: ACK Scan se usa para mapear reglas de firewall y descubrir puertos filtrados. 400 paquetes en 10 segundos confirma automatización."
hint = "ACK sin conexión establecida es anómalo. Alto volumen en poco tiempo + IP externa = escaneo malicioso."

[sub_resource type="Resource" id="11"]
resource_name = "TraficoLegitimo6"
script = ExtResource("2")
source_ip = "192.168.1.75"
target_port = 143
protocol = "TCP"
scan_type = "Conexión IMAP"
packet_count = 65
time_span = "8 minutos"
description = "Cliente de correo descargando mensajes vía IMAP. Autenticación exitosa. Sincronización de buzón de entrada."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Conexión IMAP para descargar correo electrónico. Puerto 143 es estándar para IMAP."
hint = "IMAP (puerto 143) es protocolo legítimo de correo. Volumen y duración son típicos de sincronización de email."

[sub_resource type="Resource" id="12"]
resource_name = "UDPScan"
script = ExtResource("2")
source_ip = "203.0.113.201"
target_port = 161
protocol = "UDP"
scan_type = "UDP Scan masivo"
packet_count = 500
time_span = "5 segundos"
description = "Escaneo UDP hacia puerto SNMP. Paquetes malformados sin esperar respuesta. Intento de descubrir dispositivos de red gestionables."
is_malicious = true
threat_type = "Port Scanning - UDP Scan to SNMP"
explanation = "ATAQUE: Escaneo UDP masivo hacia SNMP. SNMP (puerto 161) puede revelar información sensible de dispositivos de red."
hint = "500 paquetes UDP en 5 segundos es claramente automatizado. SNMP es protocolo sensible que debe protegerse."

[sub_resource type="Resource" id="13"]
resource_name = "TraficoLegitimo7"
script = ExtResource("2")
source_ip = "172.20.0.50"
target_port = 5432
protocol = "TCP"
scan_type = "Conexión PostgreSQL"
packet_count = 98
time_span = "20 minutos"
description = "Aplicación web consultando base de datos PostgreSQL. Queries transaccionales normales. Pool de conexiones gestionado correctamente."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Conexión de aplicación a PostgreSQL. Tráfico interno de base de datos es normal en entornos productivos."
hint = "PostgreSQL (puerto 5432) en red interna con conexiones persistentes es operación normal de aplicaciones."

[sub_resource type="Resource" id="14"]
resource_name = "ConnectScan"
script = ExtResource("2")
source_ip = "198.51.100.99"
target_port = 25
protocol = "TCP"
scan_type = "TCP Connect Scan completo"
packet_count = 600
time_span = "30 segundos"
description = "Escaneo de puerto SMTP completando handshake TCP. Múltiples intentos de conexión sin enviar datos. Enumeración de servicios de correo."
is_malicious = true
threat_type = "Port Scanning - TCP Connect Scan"
explanation = "ATAQUE: Connect Scan a puerto SMTP. 600 intentos en 30 segundos indica reconocimiento automatizado de servidores de correo."
hint = "Múltiples conexiones completas sin propósito legítimo es escaneo. Puerto 25 (SMTP) es objetivo para spam/relay."

[sub_resource type="Resource" id="15"]
resource_name = "TraficoLegitimo8"
script = ExtResource("2")
source_ip = "10.10.0.100"
target_port = 110
protocol = "TCP"
scan_type = "Sesión POP3"
packet_count = 45
time_span = "5 minutos"
description = "Cliente de correo recuperando mensajes vía POP3. Autenticación APOP exitosa. Descarga de 12 mensajes nuevos."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Sesión POP3 para descargar correo. Puerto 110 es protocolo estándar de email (aunque anticuado)."
hint = "POP3 es protocolo legítimo de correo. Bajo volumen de paquetes y tiempo razonable indican uso normal."

[sub_resource type="Resource" id="16"]
resource_name = "VerticalScan"
script = ExtResource("2")
source_ip = "203.0.113.177"
target_port = 80
protocol = "TCP"
scan_type = "Vertical Port Scan (múltiples puertos)"
packet_count = 800
time_span = "25 segundos"
description = "Escaneo secuencial de 800 puertos en una sola IP. Patrón de 1-1000. Intento de mapear todos los servicios expuestos en el host."
is_malicious = true
threat_type = "Port Scanning - Vertical Scan (Complete Port Range)"
explanation = "ATAQUE: Escaneo vertical completo (muchos puertos, un host). 800 puertos en 25 segundos es reconocimiento agresivo."
hint = "Escaneos que prueban muchos puertos en un host son reconocimiento. La velocidad confirma automatización maliciosa."

[sub_resource type="Resource" id="17"]
resource_name = "TraficoLegitimo9"
script = ExtResource("2")
source_ip = "192.168.1.150"
target_port = 8080
protocol = "TCP"
scan_type = "Proxy HTTP interno"
packet_count = 76
time_span = "12 minutos"
description = "Tráfico web canalizado a través de proxy interno. Filtrado de contenido activo. Logs de acceso web registrándose correctamente."
is_malicious = false
threat_type = ""
explanation = "Tráfico legítimo: Proxy HTTP interno (puerto 8080). Uso corporativo normal para filtrado y monitoreo de navegación."
hint = "Puerto 8080 es común para proxies HTTP internos. Red interna + volumen moderado = tráfico corporativo legítimo."

[sub_resource type="Resource" id="18"]
resource_name = "HorizontalScan"
script = ExtResource("2")
source_ip = "unknown/distributed"
target_port = 445
protocol = "TCP"
scan_type = "Horizontal Scan (múltiples hosts)"
packet_count = 1000
time_span = "40 segundos"
description = "Escaneo del puerto 445 SMB en toda la subred. Orígenes distribuidos (botnet probable). Búsqueda de vulnerabilidades EternalBlue."
is_malicious = true
threat_type = "Port Scanning - Horizontal Scan (Botnet + SMB)"
explanation = "ATAQUE CRÍTICO: Escaneo horizontal de SMB desde botnet. Puerto 445 + patrón distribuido indica búsqueda de vulnerabilidades graves."
hint = "Orígenes distribuidos + puerto 445 + alto volumen = ataque coordinado de botnet. SMB es vector crítico de ransomware."

[resource]
script = ExtResource("1")
scans = Array[ExtResource("2")]([SubResource("1"), SubResource("2"), SubResource("3"), SubResource("4"), SubResource("5"), SubResource("6"), SubResource("7"), SubResource("8"), SubResource("9"), SubResource("10"), SubResource("11"), SubResource("12"), SubResource("13"), SubResource("14"), SubResource("15"), SubResource("16"), SubResource("17"), SubResource("18")])
