[gd_resource type="Resource" script_class="NetworkLevelDatabase" load_steps=17 format=3 uid="uid://dowif7wxguhw7"]

[ext_resource type="Script" uid="uid://doas5n3ywd82h" path="res://assets/scripts/minigames/network_defender/NetworkLevelDatabase.gd" id="1"]
[ext_resource type="Script" uid="uid://cn8r4m2xvc71g" path="res://assets/scripts/minigames/network_defender/ConnectionResource.gd" id="2"]

[sub_resource type="Resource" id="1"]
resource_name = "ConexionSegura1"
script = ExtResource("2")
ip_address = "142.250.185.46"
port = 443
protocol = "HTTPS"
process_name = "chrome.exe"
reason = "Conexión legítima a Google (HTTPS estándar)"
hint = "Puerto 443 es HTTPS estándar y chrome.exe es navegador confiable"

[sub_resource type="Resource" id="2"]
resource_name = "ConexionSegura2"
script = ExtResource("2")
ip_address = "13.107.42.14"
port = 443
protocol = "HTTPS"
process_name = "teams.exe"
reason = "Conexión legítima a Microsoft Teams"
hint = "IP de Microsoft y proceso conocido de Teams"

[sub_resource type="Resource" id="3"]
resource_name = "ConexionSospechosa1"
script = ExtResource("2")
ip_address = "185.220.101.45"
port = 9001
process_name = "svchost.exe"
is_suspicious = true
reason = "Puerto 9001 usado por Tor, potencial tráfico anónimo no autorizado"
hint = "Puerto inusual (9001) asociado con redes de anonimato"

[sub_resource type="Resource" id="4"]
resource_name = "ConexionSegura3"
script = ExtResource("2")
ip_address = "140.82.121.4"
port = 22
protocol = "SSH"
process_name = "git.exe"
reason = "Conexión SSH legítima a GitHub"
hint = "Puerto 22 (SSH) con proceso git hacia servidor de GitHub"

[sub_resource type="Resource" id="5"]
resource_name = "ConexionSospechosa2"
script = ExtResource("2")
ip_address = "203.0.113.50"
port = 4444
process_name = "explorer.exe"
is_suspicious = true
reason = "Puerto 4444 comúnmente usado por malware (Metasploit), proceso sospechoso"
hint = "Explorer.exe no debería hacer conexiones de red, puerto 4444 es sospechoso"

[sub_resource type="Resource" id="10"]
resource_name = "ConexionSospechosa5"
script = ExtResource("2")
ip_address = "45.142.212.61"
port = 8080
protocol = "HTTP"
process_name = "notepad.exe"
is_suspicious = true
reason = "Notepad.exe no debería hacer conexiones de red - posible proceso inyectado"
hint = "Notepad no es un programa de red, esto es muy sospechoso"

[sub_resource type="Resource" id="11"]
resource_name = "ConexionSegura6"
script = ExtResource("2")
ip_address = "104.244.42.193"
port = 443
protocol = "HTTPS"
process_name = "twitter.exe"
reason = "Conexión legítima a Twitter/X"
hint = "HTTPS estándar hacia servidor conocido de redes sociales"

[sub_resource type="Resource" id="12"]
resource_name = "ConexionSospechosa6"
script = ExtResource("2")
ip_address = "10.0.0.50"
port = 445
protocol = "SMB"
process_name = "powershell.exe"
is_suspicious = true
reason = "PowerShell accediendo a SMB puede indicar movimiento lateral de atacante"
hint = "PowerShell + SMB (445) es técnica común de hackers para moverse en la red"

[sub_resource type="Resource" id="13"]
resource_name = "ConexionSegura7"
script = ExtResource("2")
ip_address = "34.117.186.192"
port = 443
protocol = "HTTPS"
process_name = "spotify.exe"
reason = "Conexión legítima a servicios de Spotify"
hint = "Aplicación legítima con conexión HTTPS estándar"

[sub_resource type="Resource" id="14"]
resource_name = "ConexionSospechosa7"
script = ExtResource("2")
ip_address = "185.220.101.200"
port = 6667
protocol = "IRC"
process_name = "system32.exe"
is_suspicious = true
reason = "Proceso con nombre sospechoso (system32.exe no es un ejecutable real) usando IRC para C&C"
hint = "IRC (6667) usado por botnets, y 'system32.exe' es nombre falso (la carpeta real es System32)"

[sub_resource type="Resource" id="6"]
resource_name = "ConexionSegura4"
script = ExtResource("2")
ip_address = "157.240.23.35"
port = 443
protocol = "HTTPS"
process_name = "firefox.exe"
reason = "Conexión legítima a Facebook"
hint = "HTTPS estándar desde navegador conocido"

[sub_resource type="Resource" id="7"]
resource_name = "ConexionSospechosa3"
script = ExtResource("2")
ip_address = "192.168.1.105"
port = 135
protocol = "RPC"
process_name = "unknown"
is_suspicious = true
reason = "Escaneo de red interna en puerto RPC, proceso desconocido"
hint = "IP interna con puerto RPC (135) y proceso desconocido indica escaneo"

[sub_resource type="Resource" id="8"]
resource_name = "ConexionSospechosa4"
script = ExtResource("2")
ip_address = "198.51.100.75"
port = 3389
protocol = "RDP"
process_name = "mstsc.exe"
is_suspicious = true
reason = "Intento de conexión RDP a IP externa no autorizada"
hint = "Puerto 3389 (RDP) hacia IP externa puede ser acceso remoto no autorizado"

[sub_resource type="Resource" id="9"]
resource_name = "ConexionSegura5"
script = ExtResource("2")
ip_address = "52.96.165.34"
port = 587
protocol = "SMTP"
process_name = "outlook.exe"
reason = "Conexión SMTP legítima de Outlook a Office365"
hint = "Puerto 587 (SMTP) usado por clientes de correo legítimos"

[resource]
script = ExtResource("1")
easy_levels = Array[ExtResource("2")]([SubResource("1"), SubResource("2"), SubResource("3"), SubResource("4"), SubResource("5")])
medium_levels = Array[ExtResource("2")]([SubResource("6"), SubResource("7"), SubResource("8"), SubResource("9")])
hard_levels = Array[ExtResource("2")]([SubResource("10"), SubResource("11"), SubResource("12"), SubResource("13"), SubResource("14")])
