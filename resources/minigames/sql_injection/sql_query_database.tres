[gd_resource type="Resource" script_class="SQLQueryDatabase" load_steps=18 format=3 uid="uid://bnvpg501vb7jc"]

[ext_resource type="Script" uid="uid://cun1no81o86es" path="res://assets/scripts/minigames/sql_injection/SQLQueryDatabase.gd" id="1"]
[ext_resource type="Script" uid="uid://btm0mn71f75dr" path="res://assets/scripts/minigames/sql_injection/SQLQueryResource.gd" id="2"]

[sub_resource type="Resource" id="1"]
resource_name = "ConsultaSegura1"
script = ExtResource("2")
query_text = "SELECT * FROM users WHERE username = '{INPUT}'"
user_input = "admin"
explanation = "Consulta legítima: Búsqueda normal de usuario por nombre"
hint = "El input 'admin' es un nombre de usuario válido sin caracteres especiales SQL"

[sub_resource type="Resource" id="2"]
resource_name = "AtaqueBasico"
script = ExtResource("2")
query_text = "SELECT * FROM users WHERE username = '{INPUT}'"
user_input = "admin' OR '1'='1"
is_malicious = true
attack_type = "SQL Injection Básico (OR bypass)"
explanation = "Ataque clásico: La condición OR '1'='1' siempre es verdadera, devolviendo TODOS los usuarios"
hint = "Fíjate en las comillas y el operador OR - esto cierra la consulta original y agrega una condición siempre verdadera"

[sub_resource type="Resource" id="3"]
resource_name = "ConsultaSegura2"
script = ExtResource("2")
query_text = "SELECT * FROM products WHERE category = '{INPUT}'"
user_input = "electronics"
explanation = "Consulta legítima: Búsqueda de productos por categoría"
hint = "Electronics es una categoría válida sin sintaxis SQL"

[sub_resource type="Resource" id="4"]
resource_name = "AtaqueUnionSelect"
script = ExtResource("2")
query_text = "SELECT id, name FROM products WHERE id = {INPUT}"
user_input = "1 UNION SELECT username, password FROM users"
is_malicious = true
attack_type = "UNION-based SQL Injection"
explanation = "Ataque UNION: Combina resultados de otra tabla (passwords) con la consulta original"
hint = "La palabra clave UNION permite ejecutar una segunda consulta SELECT - muy peligroso"

[sub_resource type="Resource" id="5"]
resource_name = "ConsultaSegura3"
script = ExtResource("2")
query_text = "SELECT email FROM users WHERE user_id = {INPUT}"
user_input = "12345"
explanation = "Consulta legítima: Búsqueda por ID numérico válido"
hint = "12345 es un número entero simple, sin comandos SQL"

[sub_resource type="Resource" id="6"]
resource_name = "AtaqueDrop"
script = ExtResource("2")
query_text = "SELECT * FROM users WHERE username = '{INPUT}'"
user_input = "admin'; DROP TABLE users; --"
is_malicious = true
attack_type = "SQL Injection con DROP TABLE"
explanation = "Ataque destructivo: Intenta ELIMINAR la tabla completa de usuarios. El -- comenta el resto"
hint = "DROP TABLE es un comando de destrucción. El punto y coma (;) termina la consulta original"

[sub_resource type="Resource" id="7"]
resource_name = "ConsultaSegura4"
script = ExtResource("2")
query_text = "SELECT * FROM orders WHERE status = '{INPUT}'"
user_input = "shipped"
explanation = "Consulta legítima: Filtrar pedidos por estado de envío"
hint = "Shipped es un valor de estado válido"

[sub_resource type="Resource" id="8"]
resource_name = "AtaqueComentarios"
script = ExtResource("2")
query_text = "SELECT * FROM users WHERE username = '{INPUT}' AND password = '{PASSWORD}'"
user_input = "admin' --"
is_malicious = true
attack_type = "Comment-based SQL Injection"
explanation = "Ataque con comentarios: -- comenta el resto (AND password), permitiendo login sin contraseña"
hint = "Los guiones dobles (--) son comentarios en SQL - eliminan la verificación de contraseña"

[sub_resource type="Resource" id="9"]
resource_name = "ConsultaSegura5"
script = ExtResource("2")
query_text = "SELECT * FROM articles WHERE title LIKE '%{INPUT}%'"
user_input = "cybersecurity"
explanation = "Consulta legítima: Búsqueda de artículos con palabra clave"
hint = "Cybersecurity es texto normal para búsqueda"

[sub_resource type="Resource" id="10"]
resource_name = "AtaqueStacked"
script = ExtResource("2")
query_text = "SELECT * FROM products WHERE id = {INPUT}"
user_input = "1; UPDATE users SET role='admin' WHERE username='hacker'"
is_malicious = true
attack_type = "Stacked Queries Attack"
explanation = "Consultas apiladas: Ejecuta múltiples comandos separados por ; - eleva privilegios a admin"
hint = "El punto y coma permite ejecutar un segundo comando SQL (UPDATE) después del SELECT"

[sub_resource type="Resource" id="11"]
resource_name = "ConsultaSegura6"
script = ExtResource("2")
query_text = "SELECT COUNT(*) FROM orders WHERE customer_id = {INPUT}"
user_input = "789"
explanation = "Consulta legítima: Contar pedidos de un cliente"
hint = "789 es un ID numérico simple"

[sub_resource type="Resource" id="12"]
resource_name = "AtaqueBooleanBlind"
script = ExtResource("2")
query_text = "SELECT * FROM users WHERE username = '{INPUT}'"
user_input = "admin' AND SUBSTRING(password,1,1)='a"
is_malicious = true
attack_type = "Boolean-based Blind SQL Injection"
explanation = "Ataque ciego: Extrae contraseñas carácter por carácter usando condiciones booleanas"
hint = "SUBSTRING es una función SQL para extraer partes de texto - se usa para robar datos lentamente"

[sub_resource type="Resource" id="13"]
resource_name = "ConsultaSegura7"
script = ExtResource("2")
query_text = "INSERT INTO logs (action, user) VALUES ('{INPUT}', 'system')"
user_input = "user_login"
explanation = "Consulta legítima: Registro de actividad del sistema"
hint = "user_login es un texto descriptivo válido"

[sub_resource type="Resource" id="14"]
resource_name = "AtaqueTimeBlind"
script = ExtResource("2")
query_text = "SELECT * FROM products WHERE id = {INPUT}"
user_input = "1 AND SLEEP(10)"
is_malicious = true
attack_type = "Time-based Blind SQL Injection"
explanation = "Ataque de tiempo: Usa SLEEP() para hacer que la base de datos se retrase - confirma vulnerabilidad"
hint = "SLEEP() es una función que pausa la ejecución - los atacantes la usan para detectar vulnerabilidades"

[sub_resource type="Resource" id="15"]
resource_name = "ConsultaSegura8"
script = ExtResource("2")
query_text = "DELETE FROM cart WHERE session_id = '{INPUT}'"
user_input = "abc123def456"
explanation = "Consulta legítima: Limpiar carrito de compras por ID de sesión"
hint = "abc123def456 es un ID de sesión alfanumérico normal"

[resource]
script = ExtResource("1")
queries = Array[ExtResource("2")]([SubResource("1"), SubResource("2"), SubResource("3"), SubResource("4"), SubResource("5"), SubResource("6"), SubResource("7"), SubResource("8"), SubResource("9"), SubResource("10"), SubResource("11"), SubResource("12"), SubResource("13"), SubResource("14"), SubResource("15")])
